<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
  <meta name="description" content="Karate Blackjack - A karate-themed browser-based blackjack card game">
  <meta name="theme-color" content="#1a1a2e">

  <title>Karate Blackjack</title>

  <!-- Preconnect for performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <!-- Brush stroke font for karate theme -->
  <link href="https://fonts.googleapis.com/css2?family=Permanent+Marker&display=swap" rel="stylesheet">

  <!-- Main stylesheet -->
  <link rel="stylesheet" href="css/styles.css">

  <!-- Favicon placeholder -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>%F0%9F%A5%8B</text></svg>">
</head>
<body>
  <!-- Skip link for accessibility -->
  <a href="#main-content" class="skip-link">Skip to main content</a>

  <div class="game-wrapper">
    <!-- Header Section -->
    <header class="game-header">
      <h1 class="game-title">Karate Blackjack</h1>
      <div class="header-controls">
        <!-- Settings Button -->
        <button type="button" class="btn-settings" id="settingsButton" aria-label="Settings" title="Settings">
          <span class="settings-icon" aria-hidden="true"></span>
        </button>
        <div class="volume-control" id="volumeControl">
          <button type="button" class="btn-volume-toggle" id="volumeToggle" aria-label="Toggle sound">
            <span class="volume-icon" id="volumeIcon" aria-hidden="true"></span>
          </button>
          <input type="range" class="volume-slider" id="volumeSlider"
                 min="0" max="100" value="70"
                 aria-label="Volume level">
        </div>
        <!-- Session Stats -->
        <div class="session-stats" id="sessionStats">
          <span class="stat-item stat-record" id="sessionRecord" title="Wins/Losses">W/L: 0/0</span>
          <span class="stat-item stat-profit" id="sessionProfit" title="Session profit/loss">+$0</span>
        </div>
        <div class="rank-display" id="rankDisplay">
          <span class="rank-belt" id="rankBelt"></span>
          <span class="rank-name" id="rankName">White Belt</span>
        </div>
        <div class="balance-display" id="balanceDisplay">
          <span class="balance-label">Balance:</span>
          <span class="balance-amount" id="balanceAmount">$1000</span>
        </div>
      </div>
    </header>

    <!-- Main Game Area -->
    <main id="main-content" class="game-main">
      <!-- Message Area -->
      <div class="message-area" id="messageArea">
        <p class="message-text" id="messageText">Place your bet to begin</p>
      </div>

      <!-- Game Table -->
      <div class="game-table">
        <!-- Dojo decorations -->
        <div class="dojo-lantern dojo-lantern-left" aria-hidden="true">
          <img src="assets/lantern.svg" alt="" width="40" height="60">
        </div>
        <div class="dojo-lantern dojo-lantern-right" aria-hidden="true">
          <img src="assets/lantern.svg" alt="" width="40" height="60">
        </div>

        <!-- Dealer Section -->
        <section class="dealer-section" aria-label="Dealer's hand">
          <!-- Sensei avatar -->
          <div class="character-avatar sensei-avatar" aria-hidden="true">
            <img src="assets/sensei.svg" alt="" width="60" height="75">
          </div>
          <div class="dealer-area">
            <div class="dealer-hand-container">
              <div class="hand-info">
                <span class="hand-label">ÂÖàÁîü</span>
                <span class="hand-value" id="dealerValue">--</span>
              </div>
              <div class="dealer-hand card-container" id="dealerHand">
                <!-- Dealer cards rendered here -->
              </div>
            </div>
            <!-- Deck display -->
            <div class="deck-display" id="deckDisplay" aria-label="Card deck">
              <div class="deck-stack">
                <div class="deck-card deck-card-3"></div>
                <div class="deck-card deck-card-2"></div>
                <div class="deck-card deck-card-1"></div>
              </div>
              <div class="deck-count" id="deckCount" title="Cards remaining">52</div>
            </div>
          </div>
        </section>

        <!-- Canvas for card rendering -->
        <div class="canvas-container">
          <canvas id="gameCanvas" class="game-canvas" width="800" height="400">
            Your browser does not support the canvas element.
          </canvas>
        </div>

        <!-- Player Section -->
        <section class="player-section" aria-label="Player's hands">
          <!-- Karateka avatar -->
          <div class="character-avatar karateka-avatar" id="karatekaAvatar" aria-hidden="true">
            <img src="assets/karateka.svg" alt="" width="60" height="75">
          </div>
          <!-- Player hands container (supports 1-3 hands) -->
          <div class="player-hands" id="playerHands">
            <!-- Hand 1 -->
            <div class="player-hand" id="playerHand0" data-hand-index="0">
              <div class="hand-info">
                <span class="hand-label">Hand 1</span>
                <span class="hand-value" id="playerValue0">--</span>
                <span class="hand-bet" id="playerBet0"></span>
              </div>
              <div class="card-container" id="playerCards0">
                <!-- Player cards rendered here -->
              </div>
              <div class="chip-stack" id="chipStack0" aria-label="Bet chips">
                <!-- Chip visuals rendered here -->
              </div>
              <div class="hand-result" id="handResult0"></div>
            </div>

            <!-- Hand 2 (hidden by default) -->
            <div class="player-hand hidden" id="playerHand1" data-hand-index="1">
              <div class="hand-info">
                <span class="hand-label">Hand 2</span>
                <span class="hand-value" id="playerValue1">--</span>
                <span class="hand-bet" id="playerBet1"></span>
              </div>
              <div class="card-container" id="playerCards1">
                <!-- Player cards rendered here -->
              </div>
              <div class="chip-stack" id="chipStack1" aria-label="Bet chips">
                <!-- Chip visuals rendered here -->
              </div>
              <div class="hand-result" id="handResult1"></div>
            </div>

            <!-- Hand 3 (hidden by default) -->
            <div class="player-hand hidden" id="playerHand2" data-hand-index="2">
              <div class="hand-info">
                <span class="hand-label">Hand 3</span>
                <span class="hand-value" id="playerValue2">--</span>
                <span class="hand-bet" id="playerBet2"></span>
              </div>
              <div class="card-container" id="playerCards2">
                <!-- Player cards rendered here -->
              </div>
              <div class="chip-stack" id="chipStack2" aria-label="Bet chips">
                <!-- Chip visuals rendered here -->
              </div>
              <div class="hand-result" id="handResult2"></div>
            </div>
          </div>
        </section>
      </div>
    </main>

    <!-- Controls Section -->
    <footer class="game-controls">
      <!-- Betting Controls -->
      <div class="control-group betting-controls" id="bettingControls">
        <h2 class="control-group-title visually-hidden">Betting Options</h2>

        <!-- Bet Amount Display -->
        <div class="bet-display">
          <span class="bet-label">Current Bet:</span>
          <span class="bet-amount" id="currentBetAmount">$0</span>
        </div>

        <!-- Bet Preset Buttons -->
        <div class="bet-presets">
          <button type="button" class="btn btn-bet" data-bet="10" aria-label="Bet $10">$10</button>
          <button type="button" class="btn btn-bet" data-bet="50" aria-label="Bet $50">$50</button>
          <button type="button" class="btn btn-bet" data-bet="100" aria-label="Bet $100">$100</button>
          <button type="button" class="btn btn-bet" data-bet="500" aria-label="Bet $500">$500</button>
        </div>

        <!-- Hand Count Selector -->
        <div class="hand-selector">
          <span class="selector-label">Hands:</span>
          <button type="button" class="btn btn-hand-count active" data-hands="1" aria-pressed="true">1</button>
          <button type="button" class="btn btn-hand-count" data-hands="2" aria-pressed="false">2</button>
          <button type="button" class="btn btn-hand-count" data-hands="3" aria-pressed="false">3</button>
        </div>

        <!-- Deal Button -->
        <button type="button" class="btn btn-primary btn-deal" id="dealButton" disabled>Deal</button>

        <!-- Clear Bet Button -->
        <button type="button" class="btn btn-secondary btn-clear" id="clearBetButton">Clear</button>
      </div>

      <!-- Action Controls -->
      <div class="control-group action-controls hidden" id="actionControls">
        <h2 class="control-group-title visually-hidden">Game Actions</h2>

        <button type="button" class="btn btn-action btn-hit" id="hitButton" disabled>Hit</button>
        <button type="button" class="btn btn-action btn-stand" id="standButton" disabled>Stand</button>
        <button type="button" class="btn btn-action btn-double" id="doubleButton" disabled>Double</button>
        <button type="button" class="btn btn-action btn-split" id="splitButton" disabled>Split</button>
      </div>

      <!-- Insurance Controls -->
      <div class="control-group insurance-controls hidden" id="insuranceControls">
        <h2 class="control-group-title visually-hidden">Insurance Options</h2>

        <div class="insurance-info">
          <p class="insurance-prompt">Insurance?</p>
          <p class="insurance-details" id="insuranceDetails">Cost: $50 | Pays 2:1 if dealer has blackjack</p>
        </div>
        <div class="insurance-buttons">
          <button type="button" class="btn btn-insurance btn-yes" id="insuranceYesButton">Yes</button>
          <button type="button" class="btn btn-insurance btn-no" id="insuranceNoButton">No</button>
        </div>
      </div>

      <!-- New Round Control -->
      <div class="control-group new-round-controls hidden" id="newRoundControls">
        <h2 class="control-group-title visually-hidden">Round Complete</h2>

        <button type="button" class="btn btn-primary btn-new-round" id="newRoundButton">New Round</button>
      </div>
    </footer>
  </div>

  <!-- Game State Indicator (for accessibility) -->
  <div class="sr-only" role="status" aria-live="polite" id="gameStatusAnnouncer"></div>

  <!-- Settings Panel -->
  <div class="settings-panel hidden" id="settingsPanel" role="dialog" aria-labelledby="settingsTitle">
    <div class="settings-content">
      <div class="settings-header">
        <h2 id="settingsTitle">Settings</h2>
        <button type="button" class="btn-close" id="settingsClose" aria-label="Close settings">&times;</button>
      </div>
      <div class="settings-body">
        <div class="settings-group">
          <label for="settingsVolume">Sound Volume</label>
          <input type="range" id="settingsVolume" min="0" max="100" value="70">
        </div>
        <div class="settings-group">
          <label for="animationSpeed">Animation Speed</label>
          <select id="animationSpeed">
            <option value="fast">Fast</option>
            <option value="normal" selected>Normal</option>
            <option value="slow">Slow</option>
          </select>
        </div>
        <div class="settings-group">
          <label for="tableColor">Table Color</label>
          <select id="tableColor">
            <option value="green" selected>Classic Green</option>
            <option value="blue">Royal Blue</option>
            <option value="red">Casino Red</option>
          </select>
        </div>
        <div class="settings-group">
          <label class="checkbox-label">
            <input type="checkbox" id="showDeckCount" checked>
            Show Deck Count
          </label>
        </div>
        <div class="settings-group">
          <label class="checkbox-label">
            <input type="checkbox" id="showTutorial">
            Show Tutorial on Start
          </label>
        </div>
      </div>
      <div class="settings-footer">
        <button type="button" class="btn btn-secondary" id="resetStats">Reset Stats</button>
        <button type="button" class="btn btn-primary" id="settingsSave">Save</button>
      </div>
    </div>
  </div>

  <!-- Tutorial Overlay -->
  <div class="tutorial-overlay hidden" id="tutorialOverlay" role="dialog" aria-labelledby="tutorialTitle">
    <div class="tutorial-content">
      <div class="tutorial-header">
        <h2 id="tutorialTitle">Welcome to Karate Blackjack!</h2>
        <button type="button" class="btn-close" id="tutorialClose" aria-label="Close tutorial">&times;</button>
      </div>
      <div class="tutorial-body">
        <div class="tutorial-step" data-step="1">
          <div class="tutorial-icon">üé∞</div>
          <h3>Place Your Bet</h3>
          <p>Click chip buttons ($10, $50, $100, $500) to add to your bet. Choose 1-3 hands to play.</p>
        </div>
        <div class="tutorial-step" data-step="2">
          <div class="tutorial-icon">üÉè</div>
          <h3>Know Your Actions</h3>
          <p><strong>Hit</strong> - Get another card<br>
             <strong>Stand</strong> - Keep your hand<br>
             <strong>Double</strong> - Double bet, get one card<br>
             <strong>Split</strong> - Split pairs into two hands</p>
        </div>
        <div class="tutorial-step" data-step="3">
          <div class="tutorial-icon">üéØ</div>
          <h3>Beat the Dealer</h3>
          <p>Get closer to 21 than the dealer without going over. Blackjack (Ace + 10) pays 3:2!</p>
        </div>
        <div class="tutorial-step" data-step="4">
          <div class="tutorial-icon">‚å®Ô∏è</div>
          <h3>Keyboard Shortcuts</h3>
          <p><strong>H</strong> - Hit | <strong>S</strong> - Stand | <strong>D</strong> - Double | <strong>P</strong> - Split<br>
             <strong>Space</strong> - Deal/New Round</p>
        </div>
      </div>
      <div class="tutorial-footer">
        <label class="checkbox-label">
          <input type="checkbox" id="dontShowAgain">
          Don't show again
        </label>
        <button type="button" class="btn btn-primary" id="tutorialStart">Start Playing!</button>
      </div>
    </div>
  </div>

  <!-- Main Application Script -->
  <script type="module" src="js/main.js"></script>
</body>
</html>
